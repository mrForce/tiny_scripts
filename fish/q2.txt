The code does not contain comments with the changes as the question required. An extra byte for the null terminating character '\0' must be included. (It should be malloc(len+1).)
